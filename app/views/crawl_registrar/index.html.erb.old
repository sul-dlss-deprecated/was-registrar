<script>
	$(document).ready(function() {
		$("#crawl-navbar").addClass("active");
		$("#crawl_jobs").DataTable();
		
		
	/*	
    $.ajax({
    	
        url: "/crawl_registrar/collection_list",
        type: 'get',
        data: $(this).serialize()
    }).done(function (data) {
        change_select(data);
    });

*/
		
	}); 
	
function change_select(data) {
   // var json = jQuery.parseJSON(data);
    var options = [];
    var collection_json = data['collections']
    //$("#collection_test").append($("<option></option>").attr("value","aaa").text("eeee"));
    	count = 1
        $(".collection_dropdown").each(function( index ) {

		    for( collection_item in collection_json ) {
		      //  options.push({text: collection_item['title'], value: collection_item['druid']});
			        console.log(index);//+" "+collection_item['druid']);
			        $(this).hide();
			  		$(this).append($("<option></option>").attr("value",collection_json[collection_item].druid).text(collection_item['druid']));
		$(this).show();
		    }
		});

 //    $(".collection_dropdown").replaceOptions(options);
};

</script>


<%= form_tag({controller: "crawl_registrar", action: "register"}, method: "get") do %>
	
<div class="panel panel-primary">
  <div class="panel-body">
 	<table id="crawl_jobs">
		<thead>
			<tr>
				<th>Check</th>
				
				<th>Job directory</th>
				<th>Collection</th>
			</tr>
		</thead>
		<tbody>
			<% @jobs_list.each_with_index do |job_directory, job_directory_id| %>
				<tr>
					<td>
				 		<%= check_box_tag "jobs[]", job_directory_id %> 
					</td>
					<td><%=job_directory%></td>
					<td >
						<%= select_tag(:collection_list, options_for_select(@collections_list), class:"collection_dropdown") %>
					</td>
				</tr>
			<% end %>
		</tbody>
	</table> 
	</div>
</div>
<%= submit_tag("Register", class:"btn btn-default") %>

<% end %>



